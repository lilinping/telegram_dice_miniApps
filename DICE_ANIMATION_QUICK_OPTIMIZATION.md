# 骰子动画快速优化方案

## 策略：渐进式优化

考虑到完全重写需要7-10天，我们采用**渐进式优化**策略：
1. 保留当前CSS 3D实现
2. 逐步添加新功能
3. 最终可选择性启用Three.js版本

## 第一阶段：CSS版本优化（1-2天）

### 1.1 添加透明筛盅效果
使用CSS实现半透明玻璃效果：
- backdrop-filter: blur()
- 渐变透明度
- 玻璃反光效果

### 1.2 优化动画流程
实现完整的动画状态机：
```
IDLE → COVER_DOWN → CUP_SHAKE → CUP_DROP → DICE_ROLL → CUP_UP → RESULT_SHOW
```

### 1.3 添加声效
- 摇盅声音循环
- 骰子碰撞声
- 落地声效

### 1.4 改进骰子动画
- 更真实的旋转轨迹
- 添加弹跳效果
- 微调停稳动画

## 第二阶段：Three.js版本（3-5天）

在CSS版本稳定后，并行开发Three.js版本：
- 作为高端设备的增强版
- 可通过配置切换
- 保留CSS版本作为降级

## 实现优先级

### 立即实现（今天）
1. ✅ 添加筛盅组件
2. ✅ 实现盖盅/抬盅动画
3. ✅ 优化摇盅效果

### 明天实现
1. 添加声效系统
2. 优化骰子物理感
3. 完善动画流程

### 本周实现
1. 性能优化
2. 移动端适配
3. 测试和调试

## 快速优化代码结构

```typescript
// 新增状态
type AnimationPhase = 
  | 'idle'           // 待机
  | 'cover_down'     // 盖盅
  | 'cup_shake'      // 摇盅
  | 'cup_drop'       // 落盅
  | 'dice_roll'      // 骰子滚动
  | 'cup_up'         // 抬盅
  | 'result_show';   // 展示结果

// 时间配置
const ANIMATION_DURATION = {
  cover_down: 300,
  cup_shake: 1500,
  cup_drop: 200,
  dice_roll: 1000,
  cup_up: 1000,
  result_show: 2000,
};
```

## 玻璃筛盅CSS实现

```css
.glass-cup {
  background: linear-gradient(
    135deg,
    rgba(255, 255, 255, 0.1),
    rgba(255, 255, 255, 0.05)
  );
  backdrop-filter: blur(10px);
  border: 2px solid rgba(255, 255, 255, 0.2);
  box-shadow: 
    0 8px 32px rgba(0, 0, 0, 0.1),
    inset 0 0 20px rgba(255, 255, 255, 0.1);
}
```

## 优势

### CSS优化版
- ✅ 快速实现（1-2天）
- ✅ 兼容性好
- ✅ 性能稳定
- ✅ 易于维护
- ❌ 物理效果有限

### Three.js完整版
- ✅ 真实物理
- ✅ 高级视觉效果
- ✅ 更好的沉浸感
- ❌ 开发时间长
- ❌ 性能要求高

## 决策建议

### 方案A：先优化CSS版本
**推荐** - 快速见效，风险低
1. 今天：实现筛盅和动画流程
2. 明天：添加声效和优化
3. 本周：测试和上线
4. 下周：开始Three.js版本

### 方案B：直接开发Three.js版本
风险高，时间长
1. 本周：基础架构
2. 下周：核心功能
3. 第三周：优化测试

## 我的建议

**采用方案A**，理由：
1. 快速交付价值
2. 降低风险
3. 用户体验立即提升
4. 为Three.js版本争取时间

现在开始实现CSS优化版本？
