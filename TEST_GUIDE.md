# 🎮 测试指南

## 测试用户配置

**测试用户ID**: `6784471903`  
**用户名**: 测试用户 (test_user)

所有配置已写入项目环境变量，开发环境会自动使用此测试ID。

---

## 快速开始测试

### 1️⃣ 启动开发服务器
```bash
npm run dev
```

访问: http://localhost:3000

### 2️⃣ 测试流程

#### 方式A: 使用Web应用测试（推荐）

1. **访问游戏页面**: http://localhost:3000/game
   - 自动使用测试用户ID: 6784471903
   - 查看余额和用户信息

2. **测试充值**:
   - 访问: http://localhost:3000/deposit
   - 输入金额（如1000）
   - 点击充值按钮

3. **测试游戏流程**:
   - 返回游戏页面: http://localhost:3000/game
   - 选择筹码（10/50/100/500/1000）
   - 点击下注区域进行下注
   - 等待倒计时结束查看开奖结果

4. **查看历史记录**:
   - 访问: http://localhost:3000/history

5. **查看钱包**:
   - 访问: http://localhost:3000/wallet

#### 方式B: 使用API测试工具

**浏览器测试工具**:
1. 访问: http://localhost:3000/test-telegram-api.html
2. 点击各个测试按钮验证功能
3. 查看实时返回结果

**命令行测试工具**:
```bash
node test-api.js
```
完整测试流程包括：
- 用户初始化
- 账户查询
- 充值
- 开始游戏
- 下注
- 查询游戏状态
- 结束游戏
- 余额变化

---

## 功能测试清单

### ✅ 用户相关
- [ ] 用户初始化（自动）
- [ ] 查看用户信息
- [ ] 查看余额

### ✅ 账户相关
- [ ] 账户充值
- [ ] 余额查询
- [ ] 交易记录

### ✅ 游戏流程
- [ ] 进入游戏大厅
- [ ] 查看当前局号
- [ ] 查看倒计时
- [ ] 选择筹码
- [ ] 点击下注区域
- [ ] 确认下注
- [ ] 清空下注
- [ ] 撤销单个下注
- [ ] 查看下注历史

### ✅ 开奖流程
- [ ] 倒计时归零
- [ ] 骰子动画
- [ ] 开奖结果显示
- [ ] 中奖金额结算
- [ ] 余额更新

### ✅ 其他功能
- [ ] 历史记录查询
- [ ] 排行榜
- [ ] VIP等级
- [ ] 邀请好友

---

## API接口测试

### 后端地址
```
http://46.250.168.177:8079
```

### 代理地址（开发环境）
```
http://localhost:3000/api/backend
```

### 核心接口

#### 1. 用户初始化
```
POST /api/backend/user/init/
```

#### 2. 查询余额
```
GET /api/backend/account/query/6784471903
```

#### 3. 充值
```
GET /api/backend/account/recharge/6784471903/1000
```

#### 4. 开始游戏
```
GET /api/backend/dice/start/6784471903
返回: gameId
```

#### 5. 下注
```
GET /api/backend/dice/bet/{gameId}/{chooseId}/{bet}
示例: GET /api/backend/dice/bet/xxx/1/10
```

#### 6. 查询游戏
```
GET /api/backend/dice/query/{gameId}
```

#### 7. 结束游戏
```
GET /api/backend/dice/end/{gameId}
```

#### 8. 下注选项对照表
```
GET /api/backend/dice/display
```

---

## 下注选项说明

| ID | 选项 | 赔率 | 说明 |
|----|------|------|------|
| 1-14 | 点数4-17 | 61-7倍 | 三个骰子总和 |
| 15 | 大 | 2倍 | 总和11-17 |
| 16 | 小 | 2倍 | 总和4-10 |
| 17 | 单 | 2倍 | 总和为单数 |
| 18 | 双 | 2倍 | 总和为双数 |
| 19 | 任意三 | 31倍 | 任意三个相同 |
| 20-40 | 对子 | 6倍 | 如1-1, 2-3等 |
| 41-46 | 豹子 | 181倍 | 三个相同，如1-1-1 |
| 47-52 | 单骰 | 2-4倍 | 单个骰子号码 |

---

## 测试数据

### 测试账户信息
- **用户ID**: 6784471903
- **初始余额**: 查询后端
- **测试充值**: 1000 USDT

### 测试下注示例
```javascript
// 大
chooseId: 15, bet: 100

// 小
chooseId: 16, bet: 100

// 点数10
chooseId: 7, bet: 50

// 豹子 6-6-6
chooseId: 46, bet: 10
```

---

## 常见问题

### Q: 余额不足怎么办？
**A**: 访问 http://localhost:3000/deposit 充值，或使用API:
```bash
curl http://localhost:3000/api/backend/account/recharge/6784471903/1000
```

### Q: 看不到测试用户信息？
**A**: 确保已重启开发服务器并检查环境变量：
```bash
cat .env.local
```

### Q: API请求跨域错误？
**A**: 使用代理路径 `/api/backend` 而不是直接访问后端地址

### Q: 如何重置测试数据？
**A**: 目前需要联系后端重置，或使用新的测试用户ID

---

## 开发工具

### 浏览器控制台
按 F12 打开，查看：
- Network: API请求和响应
- Console: 日志和错误信息
- Application: LocalStorage和状态

### React DevTools
安装浏览器扩展查看：
- 组件树
- Props和State
- Context值

---

## 下一步

1. ✅ 测试完整游戏流程
2. ✅ 验证所有API接口
3. ✅ 检查UI交互和动画
4. ✅ 测试错误处理
5. ✅ 验证余额计算准确性
6. ✅ 测试多局游戏连续性

**开始测试**: http://localhost:3000/game

祝测试顺利！🎲
